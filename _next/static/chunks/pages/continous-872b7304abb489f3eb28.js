(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[949],{3632:function(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.Clock=void 0;var t=function(){function e(e,a,t){void 0===t&&(t=1),this.stateTime=e,this.getRealTime=a,this.stateTimeVelocity=t,this.changePeriodRealTime=0,this.changePerRealTime=0,this.waitSet=new Set,this.realTimeAtStateTime=this.getRealTime()}return e.prototype.getRealTimePassed=function(e){return e-this.realTimeAtStateTime},e.prototype.getPassedChangePeriod=function(e){return Math.min(this.changePeriodRealTime,e)},e.prototype.computeStateTime=function(e,a){return this.stateTime+e*this.stateTimeVelocity+a*this.changePerRealTime},e.prototype.beforeChange=function(e){var a=this,t=this.getPassedChangePeriod(e);this.stateTime=this.computeStateTime(e,t),this.waitSet.forEach((function(e){e.waitTime-=a.stateTime-e.startTime,e.startTime=a.stateTime})),this.changePeriodRealTime-=t,this.realTimeAtStateTime+=e},e.prototype.afterChange=function(){var e=this;this.waitSet.forEach((function(a){clearTimeout(a.timeoutRef),a.timeoutRef=e.createWaitTimeout(a.callback,a.waitTime)}))},e.prototype.createWaitTimeout=function(e,a){return setTimeout(e,Math.max(0,Math.ceil(this.calculateRealTimeLeftTo(a))))},e.prototype.calculateRealTimeLeftTo=function(e){var a,t=this.stateTimeVelocity+this.changePerRealTime,n=t*this.changePeriodRealTime;if(e>n){var s=e-n;a=this.changePeriodRealTime+s/this.stateTimeVelocity}else a=e/t;return a},e.prototype.change=function(e,a){if(void 0===a&&(a=.1),a>1&&e<0)throw new Error("changeRate should no be over 1 when the offset is negative. We can't go backwards in time.");var t=this.getRealTimePassed(this.getRealTime());this.beforeChange(t),this.changePerRealTime=e<0?-Math.abs(a):Math.abs(a),this.changePeriodRealTime=e/this.changePerRealTime,this.afterChange()},e.prototype.wait=function(e){var a=this;return new Promise((function(t){var n=a.getRealTimePassed(a.getRealTime());a.beforeChange(n);var s=function(){a.waitSet.delete(o),t()},o={timeoutRef:a.createWaitTimeout(s,e),callback:s,waitTime:e,startTime:a.computeCurrentTime(n)};a.waitSet.add(o)}))},e.prototype.computeCurrentTime=function(e){return this.computeStateTime(e,this.getPassedChangePeriod(e))},e.prototype.getCurrentTime=function(){return this.computeCurrentTime(this.getRealTimePassed(this.getRealTime()))},e.prototype.jump=function(e){if(e<0)throw"can't jump backwards in state time";var a=this.getRealTimePassed(this.getRealTime());this.stateTime+=e,this.beforeChange(a),this.afterChange()},e.prototype.setVelocity=function(e){if(e<0)throw new Error("velocity can't be negative");var a=this.getRealTimePassed(this.getRealTime());this.beforeChange(a),this.stateTimeVelocity=e,this.afterChange()},e.prototype.getVelocity=function(){return this.stateTimeVelocity},e.prototype.destroy=function(){this.waitSet.forEach((function(e){clearTimeout(e.timeoutRef)}))},e}();a.Clock=t},3349:function(e,a,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,a,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return a[t]}})}:function(e,a,t,n){void 0===n&&(n=t),e[n]=a[t]}),s=this&&this.__exportStar||function(e,a){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(a,t)||n(a,e,t)};Object.defineProperty(a,"__esModule",{value:!0}),s(t(3632),a),s(t(9676),a),s(t(834),a)},9676:function(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0})},834:function(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.Universe=void 0;var t=function(){function e(e,a,t,n){this.createStore=e,this.compareAction=a,this.historyDuration=t,this.onChange=n,this.history=[],this.baseHelper1=e(),this.baseHelper2=e()}return e.prototype.removeOldElements=function(e){for(var a=0;a<this.history.length-1&&e-this.history[a+1].time>this.historyDuration;)a++;this.history.splice(0,a)},e.prototype.insert=function(e,a,t,n){var s;if(this.removeOldElements(a),null==t)t=a;else if(t>a)throw"time (".concat(t,") can't be bigger then current time (").concat(a,") (maybe jump the clock forwards?)");var o,c=this.findEntryIndexBefore(t,e);if(-1===c)return!1;var p=0;if(-2===c){if(null==n)throw"unable to insert action at time: ".concat(t," (too old)");c=-1}else{var r=this.history[c];o=r.result,p=t-r.time}return null==n&&(n=this.createStore()).update(o,p,e,void 0,void 0),this.history.splice(c+1,0,{action:e,time:t,result:n,deltaTime:p}),this.recalculateAfter(c+1,null===(s=this.history[c])||void 0===s?void 0:s.result),!0},e.prototype.recalculateAfter=function(e,a){if(e<this.history.length-1){var t=this.history[e],n=this.history[e+1],s=n.time-t.time,o=this.baseHelper1===a?this.baseHelper2:this.baseHelper1;o.copyFrom(n.result),n.result.update(t.result,s,n.action,n.deltaTime,a),this.recalculateAfter(e+1,o)}else this.onChange&&this.onChange()},e.prototype.findEntryIndexBefore=function(e,a){for(var t=this.history.length-1;t>=0;t--){var n=this.history[t];if(n.time<=e){if(n.time===e&&null!=a){var s=this.compareAction(n.action,a);if(s>0)continue;if(0===s)return-1}return t}}return-2},e.prototype.applyStateAt=function(e,a,t){if(t<a.time)throw"can't extrapolate state into the past";e.update(a.result,t-a.time,void 0,void 0,void 0)},e.prototype.applyCurrentState=function(e,a){this.applyStateAt(e,this.history[this.history.length-1],a)},e}();a.Universe=t},9138:function(e,a,t){"use strict";t.d(a,{$:function(){return c}});var n=t(5675),s=t(5893),o=function(e){var a=e.src;return"/co-consistent".concat(a)};function c(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex-grow-1"}),(0,s.jsx)("footer",{className:"bg-light",children:(0,s.jsxs)("div",{className:"d-flex align-items-center justify-content-around p-3 container-lg",children:[(0,s.jsxs)("a",{target:"_blank",href:"https://github.com/cocoss-org/co-consistent",className:"mx-2 text-black d-flex flex-row align-items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-github mx-2",viewBox:"0 0 16 16",children:(0,s.jsx)("path",{d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"})}),(0,s.jsx)("span",{className:"h5 mb-0",children:"Github"})]}),(0,s.jsx)("a",{className:"d-flex mx-2",target:"_blank",href:"https://www.coconut-xr.com/",children:(0,s.jsx)(n.default,{loader:o,layout:"fixed",width:170,height:40,src:"/powered-by.svg"})})]})})]})}},1655:function(e,a,t){"use strict";t.d(a,{h:function(){return p}});var n=t(1664),s=t(7294),o=t(5893),c=[{title:"State",url:"/state"},{title:"Parallel",url:"/parallel"},{title:"Continous",url:"/continous"}];function p(e){var a=e.selectedIndex,t=(0,s.useState)(!1),p=t[0],r=t[1];return(0,o.jsx)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:(0,o.jsxs)("div",{className:"container-fluid",children:[(0,o.jsx)(n.default,{href:"/",passHref:!0,children:(0,o.jsx)("a",{className:"navbar-brand",children:"co-consistent examples"})}),(0,o.jsx)("button",{className:"navbar-toggler",type:"button",onClick:function(){return r(!p)},"data-bs-toggle":"collapse","data-bs-target":"#navbarNavDropdown","aria-controls":"navbarNavDropdown","aria-expanded":"false","aria-label":"Toggle navigation",children:(0,o.jsx)("span",{className:"navbar-toggler-icon"})}),(0,o.jsx)("div",{className:"align-self-flex-end navbar-collapse ".concat(p?"":"collapse"),children:(0,o.jsx)("ul",{className:"navbar-nav",children:c.map((function(e,t){var s=e.title,c=e.url;return(0,o.jsx)("li",{className:"nav-item",children:t===a?(0,o.jsx)("span",{style:{cursor:"pointer"},className:"active nav-link",children:s}):(0,o.jsx)(n.default,{href:c,passHref:!0,children:(0,o.jsx)("a",{className:"nav-link",children:s})})},s)}))})})]})})}},1275:function(e,a,t){"use strict";t.r(a),t.d(a,{Client:function(){return R},Continous:function(){return S},default:function(){return x}});var n=t(5785),s=t(5671),o=t(3144),c=t(3349),p=t(7294),r=t(6716),m=t(8474),k=t(6798),N=t(2566),l=t(278);var u=t(4975),i=t(4593),d=t(9138),y=t(1655),f=t(7462),h=t(4925),v=t(3905),b=["components"],w={};function g(e){var a=e.components,t=(0,h.Z)(e,b);return(0,v.kt)("wrapper",(0,f.Z)({},w,t,{components:a,mdxType:"MDXLayout"}),(0,v.kt)("hr",null),(0,v.kt)("p",null,(0,v.kt)("strong",{parentName:"p"},"extrapolate state for representing the continous position of a ball")),(0,v.kt)("p",null,"The clients can all invert the direction of the ball. The state is extrapolated and recalculated by inverting the direction in the past and extrapolating in the future."),(0,v.kt)("h1",null,"Source Code"),(0,v.kt)("p",null,(0,v.kt)("a",{parentName:"p",href:"https://github.com/cocoss-org/co-consistent/blob/main/examples/pages/continous.tsx"},(0,v.kt)("inlineCode",{parentName:"a"},"continous.tsx"))),(0,v.kt)("pre",{className:"language-typescript"},(0,v.kt)("code",{parentName:"pre",className:"language-typescript"},(0,v.kt)("span",{parentName:"code",className:"token keyword"},"type")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Event"))," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    clientId",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),"\n    stateTime",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n    id",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," velocity ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0.0001"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"type")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Action"))," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    type",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"init"')," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"|")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"invert"'),"\n    id",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"class")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"ContinousState"))," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"implements")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"State"),(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Action"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">"))," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"constructor"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," value",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," directionInverted",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"boolean"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"update"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        base",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"|")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword nil"},"undefined"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        deltaTime",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        action",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Action")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"|")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword nil"},"undefined"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        prevDeltaTime",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"|")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword nil"},"undefined"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        prevBase",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"|")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword nil"},"undefined"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"void")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"action",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),"type ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"===")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"init"')," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"||")," base ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n            action",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),"type ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"invert"')," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"&&"),"\n            base",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"directionInverted")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"===")," prevBase",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),"directionInverted ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"&&"),"\n            base",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"===")," prevBase",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),"value ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"&&"),"\n            prevDeltaTime ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"===")," deltaTime\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," base",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"+")," deltaTime ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"*")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"base",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"directionInverted")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-"),"velocity ",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," velocity",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"directionInverted")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," action ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?")," base",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"directionInverted")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"!"),"base",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"directionInverted"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"copyFrom"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"ref",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"void")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"directionInverted")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ref",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"directionInverted"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ref",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"View")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    clientId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    sendSubject",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    receiveObservable",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    timeOffset",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token comment"},"//timeVelocity,"),"\n    incommingMessageDelay",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    incommingMessageDelay",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token comment"},"//timeVelocity: number"),"\n    timeOffset",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n    clientId",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),"\n    sendSubject",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Subject"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Event"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n    receiveObservable",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Observable"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Event"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token comment"},"//const [events, addEventToList] = useReducer(reduce, [])"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," clock ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useMemo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Clock")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"timeOffset",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"global",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"window")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token dom variable"},"window"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"performance"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"now"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"timeOffset",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"history",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," setHistory",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token generic-function"},(0,v.kt)("span",{parentName:"span",className:"token function"},"useState"),(0,v.kt)("span",{parentName:"span",className:"token generic class-name"},(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"HistoryEntry"),(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"ContinousState"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Action"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">>>"))),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," universe ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useMemo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," universe ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Universe")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"ContinousState")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token boolean"},"false"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"a1",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," a2",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," a1",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"id")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-")," a2",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"id"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token number"},"2000"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token function"},"setHistory"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token spread operator"},"..."),"universe",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"history"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        universe",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"insert"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                id",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Math"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"random"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                type",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"init"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getCurrentTime"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"ContinousState")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token boolean"},"false"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token function"},"setHistory"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token spread operator"},"..."),"universe",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"history"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," universe\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," setHistory",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," timeOffset",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," smoothedRef ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token generic-function"},(0,v.kt)("span",{parentName:"span",className:"token function"},"useMemo"),(0,v.kt)("span",{parentName:"span",className:"token generic class-name"},(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"{")," state",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"SmoothState")," ",(0,v.kt)("span",{parentName:"span",className:"token operator"},"|")," ",(0,v.kt)("span",{parentName:"span",className:"token keyword nil"},"undefined"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},";")," time",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token builtin"},"number")," ",(0,v.kt)("span",{parentName:"span",className:"token operator"},"|")," ",(0,v.kt)("span",{parentName:"span",className:"token keyword nil"},"undefined")," ",(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">"))),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," state",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword nil"},"undefined"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," time",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword nil"},"undefined")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," insert ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useCallback"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"currentTime",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," stateTime",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," id",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"!=")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"&&")," smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"time")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"!=")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," deltaTime ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," currentTime ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-")," smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"time"),"\n                smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"+=")," smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"velocity")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"*")," deltaTime\n                smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"velocity")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-"),"smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"velocity"),"\n                smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"time")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," currentTime\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            universe",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"insert"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                    type",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"invert"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                    id",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                currentTime",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                stateTime\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"universe",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," createLocalEvent ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useCallback"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," id ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Math"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"random"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," currentTime ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getCurrentTime"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," event",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Event")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            clientId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            stateTime",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," currentTime",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            id",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token function"},"insert"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"currentTime",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," currentTime",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," id",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        sendSubject",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"next"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"clientId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," universe",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," sendSubject",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useEffect"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," subscription ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," receiveObservable\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"pipe"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token function"},"delay"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"incommingMessageDelay",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token function"},"tap"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"let")," currentTime ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getCurrentTime"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"stateTime")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},">")," currentTime",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                        clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"jump"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"stateTime")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-")," currentTime",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                        currentTime ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getCurrentTime"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n                    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"insert"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"currentTime",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," event",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"stateTime"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," event",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"id"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"subscribe"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," subscription",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"unsubscribe"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," universe",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," clientId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," insert",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token comment"},"//<span>Time velocity: {timeVelocity.toFixed(2)}</span>"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"div\n            style",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                display",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"flex"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                flexDirection",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"column"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                margin",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"1rem"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                flexGrow",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"1"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                overflow",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"hidden"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"div style",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," border",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"1px solid"')," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Point")," clock",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," universe",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"universe",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"div",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"button onClick",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"createLocalEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"invert",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"button",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Time")," offset",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"timeOffset",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Incomming")," message delay",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"incommingMessageDelay",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"toFixed"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"div style",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," height",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"100"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," overflowY",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"auto"')," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," className",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token string"},'"border p-2 d-flex flex-column"'),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"history",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"map"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"entry",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," index",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n                        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"div className",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token string"},'"py-2 border-bottom"')," style",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," display",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"flex"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," flexDirection",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"column"')," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," key",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"index",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"action id",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"entry",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"action"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"id"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"toFixed"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token number"},"3"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"time",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"entry",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"time"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"toFixed"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"value",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"entry",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"result"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"toFixed"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token number"},"2"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"div",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"div",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"div",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Point")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    universe",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," state",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"SmoothState")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"|")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword nil"},"undefined"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},";")," time",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"|")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword nil"},"undefined")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    universe",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Universe"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"ContinousState"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n    clock",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Clock"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," marginLeft",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," time ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," setState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        marginLeft",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"0%"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        time",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getCurrentTime"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useEffect"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," realState ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"ContinousState")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token boolean"},"false"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," ref ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token dom variable"},"window"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"setInterval"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," realStateTime ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getCurrentTime"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," entry ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," universe",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"history"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"universe",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"history"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"length")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"1"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),"\n            universe",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"applyStateAt"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"realState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," entry",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," realStateTime",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"||")," smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"time")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                    value",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," realState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                    velocity",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," realState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"directionInverted")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-"),"velocity ",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," velocity",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"else")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token function"},"applySmoothing"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"time"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," realState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," realStateTime",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," abs ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Math"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"abs"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," backwards ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Math"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"floor"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"abs",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"%")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"2")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"===")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"1"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," boundedValue ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," backwards ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"1")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"abs ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"%")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"1"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," abs ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"%")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"1"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token function"},"setState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                    marginLeft",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token template-string"},(0,v.kt)("span",{parentName:"span",className:"token template-punctuation string"},"`"),(0,v.kt)("span",{parentName:"span",className:"token string"},"calc("),(0,v.kt)("span",{parentName:"span",className:"token interpolation"},(0,v.kt)("span",{parentName:"span",className:"token interpolation-punctuation punctuation"},"${"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"span",className:"token number"},"100")," ",(0,v.kt)("span",{parentName:"span",className:"token operator"},"*")," boundedValue",(0,v.kt)("span",{parentName:"span",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"span",className:"token method function property-access"},"toFixed"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"span",className:"token number"},"3"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"span",className:"token interpolation-punctuation punctuation"},"}")),(0,v.kt)("span",{parentName:"span",className:"token string"},"% - "),(0,v.kt)("span",{parentName:"span",className:"token interpolation"},(0,v.kt)("span",{parentName:"span",className:"token interpolation-punctuation punctuation"},"${"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"span",className:"token number"},"3")," ",(0,v.kt)("span",{parentName:"span",className:"token operator"},"*")," boundedValue",(0,v.kt)("span",{parentName:"span",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"span",className:"token method function property-access"},"toFixed"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"span",className:"token number"},"3"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"span",className:"token interpolation-punctuation punctuation"},"}")),(0,v.kt)("span",{parentName:"span",className:"token string"},"rem)"),(0,v.kt)("span",{parentName:"span",className:"token template-punctuation string"},"`")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                    time",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," realStateTime",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"time")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," realStateTime\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"30"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token dom variable"},"window"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"clearInterval"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"ref",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"clock",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," setState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," smoothedRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"time",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"time",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"toFixed"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"div style",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," width",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"3rem"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," height",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"3rem"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," marginLeft",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," background",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"#f00"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," borderRadius",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"100%"')," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"type")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"SmoothState"))," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    value",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n    velocity",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"applySmoothing"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n    smoothState",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"SmoothState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    smoothStateTime",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    realState",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"ContinousState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    realStateTime",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"void")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," deltaTime ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," realStateTime ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-")," smoothStateTime\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," velocityReal ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," realState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"directionInverted")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-"),"velocity ",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," velocity\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," valueReal ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," realState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," valueSmoothed ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," smoothState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token comment"},"//we are overshooting"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," vd ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"velocityReal ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"+")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token number"},"0.05")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"*")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"valueReal ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-")," valueSmoothed",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"/")," deltaTime",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"/")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"1.05"),"\n    smoothState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"velocity")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"+=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"limitAbs"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"vd ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-")," smoothState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"velocity"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," velocity ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"*")," deltaTime ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"*")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0.1"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    smoothState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"+=")," smoothState",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"velocity")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"*")," deltaTime\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"limitAbs"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"value",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," limit",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Math"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"max"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token operator"},"-"),"limit",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Math"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"min"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"limit",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," value",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n")))}g.isMDXComponent=!0;var T=t(5893);function x(){return(0,T.jsxs)("div",{className:"d-flex flex-column fullscreen",children:[(0,T.jsx)(y.h,{selectedIndex:2}),(0,T.jsxs)("div",{className:"d-flex flex-column justify-content-stretch container-lg",children:[(0,T.jsx)("div",{className:"d-flex flex-row-responsive",children:(0,T.jsx)(S,{})}),(0,T.jsx)(g,{}),(0,T.jsx)("div",{className:"p-3 flex-basis-0 flex-grow-1"})]}),(0,T.jsx)(d.$,{})]})}function S(){var e=(0,p.useMemo)((function(){return new r.x}),[]),a=(0,p.useMemo)((function(){return new Array(4).fill(null).map((function(a,t){var n="#".concat(t);return(0,T.jsx)(R,{clientId:n,timeOffset:0,incommingMessageDelay:1e3+1e3*Math.random(),receiveObservable:e.pipe((0,u.h)((function(e){return e.clientId!==n}))),sendSubject:e},t)}))}),[e]);return(0,T.jsx)("div",{style:{fontFamily:"arial",display:"flex",flexWrap:"wrap",flexDirection:"row",justifyContent:"space-around"},children:a})}var j=1e-4,C=function(){function e(a,t){(0,s.Z)(this,e),this.value=a,this.directionInverted=t}return(0,o.Z)(e,[{key:"update",value:function(e,a,t,n,s){"init"!==(null===t||void 0===t?void 0:t.type)&&null!=e&&("invert"==(null===t||void 0===t?void 0:t.type)&&e.directionInverted===(null===s||void 0===s?void 0:s.directionInverted)&&e.value===(null===s||void 0===s?void 0:s.value)&&n===a||(this.value=e.value+a*(e.directionInverted?-1e-4:j),this.directionInverted=null==t?e.directionInverted:!e.directionInverted))}},{key:"copyFrom",value:function(e){this.directionInverted=e.directionInverted,this.value=e.value}}]),e}();function R(e){var a=e.clientId,s=e.sendSubject,o=e.receiveObservable,r=e.timeOffset,u=e.incommingMessageDelay,d=(0,p.useMemo)((function(){return new c.Clock(r,(function(){return null==t.g.window?0:window.performance.now()}))}),[r]),y=(0,p.useState)([]),f=y[0],h=y[1],v=(0,p.useMemo)((function(){var e=new c.Universe((function(){return new C(0,!1)}),(function(e,a){return e.id-a.id}),2e3,(function(){h((0,n.Z)(e.history))}));return e.insert({id:Math.random(),type:"init"},d.getCurrentTime(),0,new C(0,!1)),h((0,n.Z)(e.history)),e}),[d,h,r]),b=(0,p.useMemo)((function(){return{state:void 0,time:void 0}}),[]),w=(0,p.useCallback)((function(e,a,t){if(null!=b.state&&null!=b.time){var n=e-b.time;b.state.value+=b.state.velocity*n,b.state.velocity=-b.state.velocity,b.time=e}v.insert({type:"invert",id:t},e,a)}),[v,b]),g=(0,p.useCallback)((function(){var e=Math.random(),t=d.getCurrentTime(),n={clientId:a,stateTime:t,id:e};w(t,t,e),s.next(n)}),[a,d,v,s]);return(0,p.useEffect)((function(){var e=o.pipe((0,i.g)(u),function(e,a,t){var n=(0,m.m)(e)||a||t?{next:e,error:a,complete:t}:e;return n?(0,k.e)((function(e,a){var t;null===(t=n.subscribe)||void 0===t||t.call(n);var s=!0;e.subscribe(new N.Q(a,(function(e){var t;null===(t=n.next)||void 0===t||t.call(n,e),a.next(e)}),(function(){var e;s=!1,null===(e=n.complete)||void 0===e||e.call(n),a.complete()}),(function(e){var t;s=!1,null===(t=n.error)||void 0===t||t.call(n,e),a.error(e)}),(function(){var e,a;s&&(null===(e=n.unsubscribe)||void 0===e||e.call(n)),null===(a=n.finalize)||void 0===a||a.call(n)})))})):l.y}((function(e){var a=d.getCurrentTime();e.stateTime>a&&(d.jump(e.stateTime-a),a=d.getCurrentTime()),w(a,e.stateTime,e.id)}))).subscribe();return function(){return e.unsubscribe()}}),[d,v,a,w]),(0,T.jsxs)("div",{style:{display:"flex",flexDirection:"column",margin:"1rem",flexGrow:1,overflow:"hidden"},children:[(0,T.jsx)("div",{style:{border:"1px solid"},children:(0,T.jsx)(I,{clock:d,smoothedRef:b,universe:v})}),(0,T.jsx)("button",{onClick:function(){return g()},children:"invert"}),(0,T.jsxs)("span",{children:["Time offset: ",r]}),(0,T.jsxs)("span",{children:["Incomming message delay: ",u.toFixed(0)]}),(0,T.jsx)("div",{style:{height:100,overflowY:"auto"},className:"border p-2 d-flex flex-column",children:f.map((function(e,a){var t;return(0,T.jsxs)("div",{className:"py-2 border-bottom",style:{display:"flex",flexDirection:"column"},children:[(0,T.jsxs)("span",{children:["action id: ",e.action.id.toFixed(3)]}),(0,T.jsxs)("span",{children:["time: ",e.time.toFixed(0)]}),(0,T.jsxs)("span",{children:["value: ",null===(t=e.result.value)||void 0===t?void 0:t.toFixed(2)]})]},a)}))})]})}function I(e){var a=e.universe,t=e.smoothedRef,n=e.clock,s=(0,p.useState)((function(){return{marginLeft:"0%",time:n.getCurrentTime()}})),o=s[0],c=o.marginLeft,r=o.time,m=s[1];return(0,p.useEffect)((function(){var e=new C(0,!1),s=window.setInterval((function(){var s=n.getCurrentTime(),o=a.history[a.history.length-1];if(a.applyStateAt(e,o,s),null==t.state||null==t.time)t.state={value:e.value,velocity:e.directionInverted?-1e-4:j};else{!function(e,a,t,n){var s=n-a,o=t.directionInverted?-1e-4:j,c=t.value,p=e.value,r=(o+.05*(c-p)/s)/1.05;e.velocity+=(m=r-e.velocity,k=j*s*.1,Math.max(-k,Math.min(k,m))),e.value+=e.velocity*s;var m,k}(t.state,t.time,e,s);var c=Math.abs(t.state.value),p=Math.floor(c)%2===1?1-c%1:c%1;m({marginLeft:"calc(".concat((100*p).toFixed(3),"% - ").concat((3*p).toFixed(3),"rem)"),time:s})}t.time=s}),30);return function(){return window.clearInterval(s)}}),[n,m,t]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("span",{children:["time: ",r.toFixed(0)]}),(0,T.jsx)("div",{style:{width:"3rem",height:"3rem",marginLeft:c,background:"#f00",borderRadius:"100%"}})]})}},6919:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/continous",function(){return t(1275)}])}},function(e){e.O(0,[667,631,774,888,179],(function(){return a=6919,e(e.s=a);var a}));var a=e.O();_N_E=a}]);